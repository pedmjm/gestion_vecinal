{% extends "base.html" %}

{% block title %}Nuevo Usuario{% endblock %}

{% block content %}
<div class="header">
    <h1 class="header-title">Crear Nuevo Usuario</h1>
    
    <div class="user-menu-container">
        <button class="user-btn" onclick="toggleMenu()">
            {{ current_user.username }}
            <span>‚ñº</span>
        </button>
        <div class="dropdown-menu" id="userMenu">
            <a href="{{ url_for('perfil') }}">Mi Perfil</a>
            <a href="{{ url_for('dashboard') }}">Dashboard</a>
            <a href="{{ url_for('nuevo_producto') }}">Nuevo Producto</a>
            <a href="{{ url_for('nuevo_servicio') }}">Nuevo Servicio</a>
            
            {% if es_admin %}
            <div class="menu-divider"></div>
            <a href="{{ url_for('gestion_categorias') }}" style="color: #667eea; font-weight: bold;">
                ‚öôÔ∏è Gestionar Categor√≠as
            </a>
            <a href="{{ url_for('admin_usuarios') }}" style="color: #667eea; font-weight: bold;">
                üë• Administrar Usuarios
            </a>
            {% endif %}
            
            <div class="menu-divider"></div>
            <a href="{{ url_for('logout') }}" style="color: #dc3545;">Cerrar Sesi√≥n</a>
        </div>
    </div>
</div>

<div class="main-content">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}
    
    <div class="section">
        <h2 class="section-title">Registrar Nuevo Usuario</h2>
        
        <form method="POST" action="{{ url_for('nuevo_usuario') }}" style="max-width: 500px; margin: 0 auto;">
            <div style="display: grid; gap: 1rem;">
                <div class="form-group">
                    <label for="username">Numero de telefono *</label>
                    <input type="text" id="username" name="username" required
                           placeholder="Ej: 0912345678">
                </div>
                
                
                <div class="form-group">
                    <label for="password">Contrase√±a *</label>
                    <input id="password" name="password" required
                           placeholder="M√≠nimo 8 caracteres" value="{{ psw }}">
                    <small style="color: #666; display: block; margin-top: 0.25rem;">
                        La contrase√±a debe tener al menos 8 caracteres, una may√∫scula, una min√∫scula y un n√∫mero.
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="role">Rol *</label>
                    <select id="role" name="role" required>
                        <option value="usuario" selected>Usuario Normal</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>
            </div>
            
            <div style="margin-top: 1.5rem; display: flex; gap: 1rem;">
                <button type="submit" class="btn-login">Crear Usuario</button>
                <button type="button" class="btn-login" 
                        onclick="location.href='{{ url_for('admin_usuarios') }}'" 
                        style="background: #6c757d;">
                    Cancelar
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}